<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="利用公网IP+内网穿透访问本地服务"><meta name="keywords" content="网络配置,内网穿透"><meta name="author" content="Links"><meta name="copyright" content="Links"><title>利用公网IP+内网穿透访问本地服务 | Blog of Links</title><link rel="shortcut icon" href="/img/my-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.3.0'
} </script><meta name="generator" content="Hexo 6.3.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2025-09-06%E6%9B%B4%E6%96%B0"><span class="toc-number">1.</span> <span class="toc-text">2025.09.06更新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E5%AF%B9%E7%82%B9%E4%B8%8EC-x2F-S%E6%96%B9%E6%A1%88"><span class="toc-number">2.</span> <span class="toc-text">点对点与C&#x2F;S方案</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F"><span class="toc-number">3.</span> <span class="toc-text">内网穿透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Frp"><span class="toc-number">3.1.</span> <span class="toc-text">Frp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NPS"><span class="toc-number">3.2.</span> <span class="toc-text">NPS</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF"><span class="toc-number">3.2.1.</span> <span class="toc-text">服务端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">3.2.2.</span> <span class="toc-text">客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#docker"><span class="toc-number">3.2.3.</span> <span class="toc-text">docker</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/Taiho.jpg"></div><div class="author-info__name text-center">Links</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">5</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">8</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">1</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/jingliu.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Blog of Links</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">利用公网IP+内网穿透访问本地服务</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2025-01-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E6%95%99%E7%A8%8B/">教程</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h2 id="2025-09-06更新"><a href="#2025-09-06更新" class="headerlink" title="2025.09.06更新"></a>2025.09.06更新</h2><p>当前NPS已有非常严重的安全问题，攻击者可能绕过账户密码在管理界面设置代理将你的机器作为跳板机，如果在NPS管理中出现不是自己设置的配置，必须马上关闭NPS服务，以避免损失。本人被消耗了450G流量，所幸攻击者并未攻击局域网内的其他机器<del>可能是没有价值罢</del>，而是通过穿透客户端作为跳板访问外网，因此损失较小。本文中NPS相关章节已删除，警钟长鸣。</p>
<h2 id="点对点与C-x2F-S方案"><a href="#点对点与C-x2F-S方案" class="headerlink" title="点对点与C&#x2F;S方案"></a>点对点与C&#x2F;S方案</h2><p>上回说到异地组网的方案，虽然免费，高速，但是随着长时间的使用，也出现了一些问题。</p>
<ol>
<li>设备要支持开启客户端<br>这其实不是一个大问题，电脑和手机可以开启客户端是理所当然的，这部分设备带出门也可以使用，而其他无法开启客户端的设备也可以通过路由器进行组网，这部分设备一般不会带出门，影响不大。<del>我其实就是不想每次都要点开客户端</del></li>
<li>对网络环境的要求较高<br>虽然有一端是IPV6公网的设备，但如果你正处于较差的网络环境中(例如商场、咖啡店和酒店的公共WiFi)，此时开启点对点穿透，可能会出现无法连接上服务提供商的节点，或者打洞失败的情况。以ZeroTier和Tailscale举例，如果打洞失败，则会使用自身的节点直接转发，但此时的速度就无法保证了。因此，点对点的穿透方案较为适合在多个固定的地点部署，实现多个地点之间的异地组网。</li>
<li>对客户端的审查风险<br>如果你在公司或者安全要求较高的地点打开点对点内网穿透，虽然管理人员无法获取你与另一边的传输内容，但是可以探测到你正在使用此类服务，从而对你发出警告。<del>我真的被警告过</del><span id="more"></span>
所以，一个公网IPV4服务器还是很有必要的，可以弥补点对点内网穿透没有覆盖的情境，我将这种需求总结为两点：</li>
<li>高通用性——哪里都能用</li>
<li>低流量——在无法点对点穿透的场景使用，频率较低，降低公网服务器的使用成本<br>通过两种方法共同覆盖自己的访问需求，从我的实际应用来说，大流量交换的需求在家进行，离开路由器则使用公网服务。</li>
</ol>
<h2 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h2><p>接下来就是内网穿透的方案，由于有公网服务器的参与，这部分的原理较为简单，现存的软件都比较轻量化，试用过后，我觉得Frp和NPS是其中较为好用的两种。两者略有不同，可以按需选择。</p>
<p>首先是NPS，NPS的端口配置部分在服务器上，客户端只作为一个终端连接上服务器。这种架构比较适合个人用户控制名下的所有客户端，可以先将客户端连接到服务器，再决定要穿透哪些服务，或者随时关闭服务。</p>
<p>Frp的配置方法和NPS相反，所有的配置文件存储在客户端，服务器则负责提供内网穿透服务供客户端使用。这种架构比较适合将内网穿透服务公开给非特定的人群使用，有需要的用户都可以通过鉴权或非鉴权的方式登录到服务器，自行配置内网穿透服务，在配置的层面做到互不干扰。</p>
<p>(2025.09.06更新)在内网穿透的C&#x2F;S架构中，暴露于公网的服务端受到攻击的概率远高于位于局域网的客户端，对服务端的软件安全性提出的更高的要求。并且，局域网内设备的价值一般也远高于仅提供公网出口的服务端。因此，如果配置文件在服务端，则管理端被攻击后，攻击者可以随意访问局域网内设备，反之，如果配置在客户端，就算服务端被攻破，攻击者也只能使用服务端的穿透服务，局域网并没有对攻击者开放出更多内容。现在想来，在有公网IP的服务端配置固然比无法随时访问的客户端配置方便，但是在安全性方便牺牲太多，还是Frp的架构较为合理。</p>
<h3 id="Frp"><a href="#Frp" class="headerlink" title="Frp"></a>Frp</h3><ol>
<li>通过wget或其他方式将安装包传输至服务器并解压</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在github页面找一个最新链接</span></span><br><span class="line">wget https://github.com/fatedier/frp/releases/download/v0.64.0/frp_0.64.0_linux_amd64.tar.gz </span><br><span class="line">mkdir frp</span><br><span class="line">tar -zxvf frp_0.64.0_linux_amd64.tar.gz -C frp</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>配置服务端</li>
</ol>
<p>根据官方的frps_full_example.toml文件，修改frps.toml，此处提供一个最简服务端配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">bindPort</span> <span class="string">=</span> <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改开放的服务端DashBoard端口和账户密码，DashBoard仅能查看当前在线的客户端</span></span><br><span class="line"><span class="string">webServer.addr</span> <span class="string">=</span> <span class="string">&quot;0.0.0.0&quot;</span> </span><br><span class="line"><span class="string">webServer.port</span> <span class="string">=</span> <span class="number">7500</span></span><br><span class="line"><span class="string">webServer.user</span> <span class="string">=</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line"><span class="string">webServer.password</span> <span class="string">=</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 鉴权token</span></span><br><span class="line"><span class="string">auth.method</span> <span class="string">=</span> <span class="string">&quot;token&quot;</span></span><br><span class="line"><span class="string">auth.token</span> <span class="string">=</span> <span class="string">&quot;12345678&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>启动服务端</li>
</ol>
<p>建议先通过命令启动服务端看看效果，如果配置不对此处会报错</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c ./frps.toml</span><br></pre></td></tr></table></figure>
<p>如果步骤正确，则执行命令后，可以通过IP:Port访问面板。但是，此时frps运行于前台，这显然不是持久化的方案，我们需要将frps转为一个服务，通过systemd管理，以下为官方文档的内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/systemd/system/frps.service</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务名称，可自定义</span></span><br><span class="line">Description = frp server</span><br><span class="line">After = network.target syslog.target</span><br><span class="line">Wants = network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type = simple</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动frps的命令，需修改为您的frps的安装路径</span></span><br><span class="line">ExecStart = /path/to/frps -c /path/to/frps.toml</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy = multi-user.target</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动frp</span></span><br><span class="line">sudo systemctl start frps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">停止frp</span></span><br><span class="line">sudo systemctl stop frps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启frp</span></span><br><span class="line">sudo systemctl restart frps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看frp状态</span></span><br><span class="line">sudo systemctl status frps</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>配置客户端</li>
</ol>
<p>客户端配置文件为frpc.toml。同样，此处提供一个最简的TCP单端口代理的配置文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">serverAddr</span> <span class="string">=</span> <span class="string">&quot;x.x.x.x&quot;</span></span><br><span class="line"><span class="string">serverPort</span> <span class="string">=</span> <span class="number">7000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># token需要和服务端配置一致，否则无法连接</span></span><br><span class="line"><span class="string">auth.method</span> <span class="string">=</span> <span class="string">&quot;token&quot;</span></span><br><span class="line"><span class="string">auth.token</span> <span class="string">=</span> <span class="string">&quot;12345678&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将本地443端口映射到服务端的443端口</span></span><br><span class="line">[[<span class="string">proxies</span>]]</span><br><span class="line"><span class="string">name</span> <span class="string">=</span> <span class="string">&quot;https&quot;</span></span><br><span class="line"><span class="string">type</span> <span class="string">=</span> <span class="string">&quot;tcp&quot;</span></span><br><span class="line"><span class="string">localIP</span> <span class="string">=</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="string">localPort</span> <span class="string">=</span> <span class="number">443</span></span><br><span class="line"><span class="string">remotePort</span> <span class="string">=</span> <span class="number">443</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>启动客户端</li>
</ol>
<p>参考步骤3，将其中的frps改为frpc即可，相信看到这里的你肯定会的。</p>
<h3 id="NPS"><a href="#NPS" class="headerlink" title="NPS"></a>NPS</h3><p><del>接下来详细介绍如何在服务端和客户端配置NPS</del></p>
<h4 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h4><ol>
<li><p>通过wget或其他方式将安装包传输至服务器并解压</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/ehang-io/nps/releases/download/v0.26.10/linux_amd64_server.tar.gz</span><br><span class="line">mkdir nps</span><br><span class="line">tar -zxvf ./linux_amd64_server.tar.gz -C nps</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入nps文件夹中，安装nps</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 ./nps # 如果需要权限</span><br><span class="line">./nps install # 安装</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改配置文件，以下提供一些建议修改的部分</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/nps/conf/nps.conf</span></span><br><span class="line"><span class="comment">#修改web的默认账号密码端口</span></span><br><span class="line"><span class="string">web_username=admin</span></span><br><span class="line"><span class="string">web_password=123</span></span><br><span class="line"><span class="string">web_port</span> <span class="string">=</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#http代理 建议删除</span></span><br><span class="line"><span class="comment">#HTTP(S) proxy port, no startup if empty</span></span><br><span class="line"><span class="string">http_proxy_ip=0.0.0.0</span></span><br><span class="line"><span class="string">http_proxy_port=80</span></span><br><span class="line"><span class="string">https_proxy_port=443</span></span><br><span class="line"><span class="string">https_just_proxy=true</span></span><br><span class="line"><span class="comment">#default https certificate setting</span></span><br><span class="line"><span class="string">https_default_cert_file=conf/server.pem</span></span><br><span class="line"><span class="string">https_default_key_file=conf/server.key</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./nps start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">其他命令</span></span><br><span class="line">./nps stop|restart</span><br><span class="line">./nps update|uninstall</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务器ip:8080进入web设置界面，通过配置文件设置的密码登录nps，点击左边菜单的客户端-新增，进入客户端设置，可以使用默认配置新增一个客户端，也可以自定义。完成后刷新，点击红框处的+号可以查看客户端命令，接下来会用到。</p>
</li>
</ol>
<p><img src="http://cdnjson.com/images/2025/02/12/CopyQ.IjfVCK.png"></p>
<h4 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h4><ol>
<li>下载对应的客户端，参照服务端的第1步，客户端为client后缀的压缩包</li>
<li>进入文件夹，执行上文提到的客户端命令，根据情况不同，建议在server和veky上增加双引号，如下所示</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./npc -server=&quot;xxx&quot; -vkey=&quot;xxx&quot; -type=tcp</span><br></pre></td></tr></table></figure>

<p>通过这种方法启动，只要关闭终端，程序就关闭了。<br>当然，npc也是支持安装的，其实就是上面nps的命令。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./npc install -server=&quot;xxx&quot; -vkey=&quot;xxx&quot; # 或者-config=xxx</span><br><span class="line">./npc start</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">其他命令</span></span><br><span class="line">./npc stop|restart</span><br><span class="line">./npc update|uninstall</span><br></pre></td></tr></table></figure>

<p>也支持通过配置文件连接</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">common</span>]</span><br><span class="line"><span class="string">server_addr=127.0.0.1:8024</span> <span class="comment">#修改</span></span><br><span class="line"><span class="string">conn_type=tcp</span></span><br><span class="line"><span class="string">vkey=123</span> <span class="comment">#修改</span></span><br><span class="line"><span class="string">auto_reconnection=true</span></span><br><span class="line"><span class="string">max_conn=1000</span></span><br><span class="line"><span class="string">flow_limit=1000</span></span><br><span class="line"><span class="string">rate_limit=1000</span></span><br><span class="line"><span class="string">basic_username=11</span></span><br><span class="line"><span class="string">basic_password=3</span></span><br><span class="line"><span class="string">web_username=user</span></span><br><span class="line"><span class="string">web_password=1234</span></span><br><span class="line"><span class="string">crypt=true</span></span><br><span class="line"><span class="string">compress=true</span></span><br><span class="line"><span class="comment">#pprof_addr=0.0.0.0:9999</span></span><br><span class="line"><span class="string">disconnect_timeout=60</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>连接成功之后，在服务端的web页面客户端菜单中，此条目的[连接]状态会变为[在线]。</li>
</ol>
<h4 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h4><p>如果你由于各种原因不能使用完整的linux环境，nps也有第三方的docker方案，需要将配置文件映射到容器。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/iAsuma/nps-docker">https://github.com/iAsuma/nps-docker</a></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 服务端</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nps:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">iasuma/nps</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nps</span></span><br><span class="line">    <span class="attr">volumes:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">./conf:/etc/nps/conf:rw</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 客户端</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nps:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">iasuma/npc</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">npc</span></span><br><span class="line">    <span class="attr">volumes:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">./conf:/etc/npc/conf:rw</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span></span><br></pre></td></tr></table></figure>


</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Links</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://blog.taiho.cc/post/Nat/">http://blog.taiho.cc/post/Nat/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/">网络配置</a><a class="post-meta__tags" href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/">内网穿透</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/post/Truenas1/"><span>Truenas Scale踩坑——共享数据集与数据保护</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/img/jingliu.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2025 By Links</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>